---
layout: layouts/base.njk
---
{% set parentSlug = parent_product_slug %}
{% set parentUrl = '/shop/' %}
{% if parentSlug %}
  {% set parentUrl = '/shop/' ~ parentSlug ~ '/' %}
{% endif %}
{% set matchingProducts = collections.products | filterByData('slug', parentSlug) %}
{% set parentProduct = matchingProducts and matchingProducts[0] %}
{% set parentCurrency = parentProduct and parentProduct.data and parentProduct.data.currency or 'CAD' %}
{% set parentPrice = parentProduct and parentProduct.data and parentProduct.data.price %}
{% set shopifyUrl = (site and site.shopify_url) or 'https://katisunraystudio.myshopify.com/?utm_source=katisunray.io' %}

<article class="py-10">
  <div class="container-custom">
    <a href="{{ parentUrl | url }}" class="btn-secondary inline-flex items-center gap-1 px-4 py-2 text-sm">‚Üê Back to {{ parent_page_label or 'Shop' }}</a>
    <h1 class="mt-4 text-3xl md:text-4xl font-semibold tracking-tight">{{ title }}</h1>
    <div class="mt-8 grid gap-8 md:grid-cols-[minmax(0,1fr)]">
      <div class="md:grid md:grid-cols-2 md:items-start md:gap-10">
        {% if hero_image and hero_image.src %}
          <div class="rounded-xl overflow-hidden border bg-gray-50 media-contain">
            {% img hero_image.src, hero_image.alt or (title ~ ' hero image'), [640, 960, 1280], '(min-width: 1024px) 40vw, 100vw' %}
          </div>
        {% endif %}
        <div class="mt-6 md:mt-0">
          {% if summary %}
            <p class="text-base leading-relaxed text-slate-700">{{ summary }}</p>
          {% endif %}
          {% if parentPrice %}
            <p class="mt-4 text-lg font-semibold text-neutral-800">${{ parentPrice }} {{ parentCurrency }}</p>
          {% endif %}
          {% if content %}
            <div class="mt-4 text-base leading-relaxed text-slate-700 space-y-4 max-w-prose">{{ content | safe }}</div>
          {% endif %}
          <div class="mt-6 flex flex-wrap items-center gap-3">
            <a href="{{ shopifyUrl }}" class="btn-primary inline-flex items-center gap-2" target="_blank" rel="noopener">
              Shop Now
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M12 5l7 7-7 7"></path>
              </svg>
            </a>
          </div>
        </div>
      </div>
    </div>

    {% if skus and skus.length %}
      <section class="mt-14">
        <h2 class="text-2xl md:text-3xl font-semibold tracking-tight">Available SKUs</h2>
        {% if order_prompt %}
          <p class="mt-3 text-base leading-relaxed text-slate-700 max-w-2xl">{{ order_prompt }}</p>
        {% endif %}
        <div class="mt-8 grid gap-8 sm:grid-cols-2 lg:grid-cols-2">
          {% for sku in skus %}
            <div class="flex flex-col border rounded-lg overflow-hidden bg-white hover:shadow-md transition-shadow">
              {% if sku.image and sku.image.src %}
                <div class="bg-gray-50">
                  {% img sku.image.src, sku.image.alt or (sku.name or sku.id), [360, 600, 840], '(min-width: 1280px) 22vw, (min-width: 768px) 45vw, 100vw' %}
                </div>
              {% endif %}
              <div class="p-4 flex flex-col gap-2 flex-1">
                <p class="text-xs font-semibold tracking-wide text-slate-600 uppercase">SKU {{ sku.id }}</p>
                {% if sku.name %}
                  <p class="text-base font-medium">{{ sku.name }}</p>
                {% endif %}
                {% if sku.message %}
                  <p class="text-sm text-slate-600">{{ sku.message }}</p>
                {% endif %}
                {% if sku.description %}
                  <p class="text-sm text-slate-600 leading-relaxed">{{ sku.description }}</p>
                {% endif %}
              </div>
            </div>
          {% endfor %}
        </div>
      </section>
    {% endif %}
  </div>
</article>
