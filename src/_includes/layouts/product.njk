---
layout: layouts/base.njk
---
{% set schema_product = {
  '@context': 'https://schema.org',
  '@type': 'Product',
  name: title,
  image: images | pluck('src'),
  description: seo and seo.description or content | striptags | truncate(160),
  offers: {
    '@type': 'Offer',
    price: price,
    priceCurrency: currency or 'CAD',
    availability: in_stock and 'https://schema.org/InStock' or 'https://schema.org/OutOfStock',
    url: buy_url
  }
} %}

<article class="py-10">
  <div class="container-custom">
    <a href="{{ '/shop/' | url }}" class="btn-secondary inline-flex items-center gap-1 px-4 py-2 text-sm">‚Üê Back to Shop</a>
    <h1 class="mt-2 text-3xl md:text-4xl font-semibold tracking-tight">{{ title }}</h1>
    {% set gallery = images | filterDetailImages %}
    <div class="mt-8 grid md:grid-cols-2 gap-10 lg:gap-16 items-start">
      <div>
        {% if gallery and gallery.length %}
          {% set primary = gallery[0] %}
        <div class="mb-4 max-w-xl">{% img primary.src, title %}</div>
        {% if gallery.length > 1 %}
          <div class="grid grid-cols-3 sm:grid-cols-4 gap-3 max-w-xl">
            {% for image in gallery %}
              {% if not loop.first %}
                <div class="border rounded overflow-hidden">{% img image.src, title, [300,600] %}</div>
              {% endif %}
            {% endfor %}
          </div>
        {% endif %}
      {% endif %}
      </div>
      <div>
      <div class="text-lg leading-relaxed space-y-4 max-w-prose">{{ content | safe }}</div>
      <p class="mt-6 text-xl"><span class="font-semibold">{{ price }}</span> {{ currency or 'CAD' }}</p>
      {% if in_stock %}
        <div class="mt-1 text-sm text-green-700">In stock</div>
      {% endif %}
      {% if buy_url %}
        {% set lowerUrl = buy_url | lower %}
        {% set buyLabel = 'Buy' %}
        {% if lowerUrl and (lowerUrl | startsWith('mailto:')) %}
          {% set buyLabel = 'Order by Email' %}
        {% endif %}
        <a href="{{ buy_url }}" class="btn-primary inline-block mt-4">{{ buyLabel }}</a>
      {% endif %}
      {% if type %}
        <div class="mt-4 inline-block text-xs uppercase tracking-wide bg-beige px-2 py-1 rounded-md">{{ type }}</div>
      {% endif %}
      </div>
    </div>
  </div>
</article>
